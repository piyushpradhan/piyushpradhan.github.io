I"X<p>In the past week, I‚Äôve been spending my time playing around with cloud services, deploying random stuff just to try and figure out how it‚Äôs being used.
I also wanted to have a vulnerable environment to try and extract something that isn‚Äôt usually made available.
It was then when I stumbled across this <code class="language-plaintext highlighter-rouge">flaws.cloud</code>.</p>

<p>It is basically a cloud CTF, deployed on AWS. Explains about some common misconfigurations and how to take advantage of those mistakes.</p>

<h1 id="lets-start-with-level-1">Let‚Äôs start with Level 1</h1>

<h3 id="finding-the-subdomain-that-contains-s3-bucket-for-flawscloud">Finding the subdomain that contains s3 bucket for <code class="language-plaintext highlighter-rouge">flaws.cloud</code></h3>

<ul>
  <li>AWS S3 buckets follow this pattern</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bucket-name.s3.region.amazonaws.com
bucket-name.s3.amazonaws.com
</code></pre></div></div>

<p>In this case, a little bit of google dorking will be enough</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flaws.cloud site:s3.amazonaws.com
</code></pre></div></div>

<p><strong>S3 Buckets should configured so that they are not publicly available. If the bucket policy is modified to allow everybody ‚Äús3:GetObject‚Äù privilege, then anyone can access the bucket.</strong></p>

<p>The first link had the contents of the s3 bucket in XML format
I thought I‚Äôll be able to find something interesting in robots.txt file‚Ä¶
<img src="/assets/images/flaws-cloud/xml-in-bucket.png" alt="" /></p>

<p>but‚Ä¶
<img src="/assets/images/flaws-cloud/robots-contents.png" alt="" /></p>

<p>Looking further I found something that actually was a hint
<img src="/assets/images/flaws-cloud/actual-hint.png" alt="" />
<strong>secret-dd02c7c.html</strong> was the page I was looking for.
That page gave me the link to the <strong>Second Level</strong></p>

<h1 id="levelling-up-level-2">Levelling up (Level 2)</h1>

<p>For this challenge, use of <code class="language-plaintext highlighter-rouge">aws-cli</code> was required.</p>

<p>Setting it up is fairly easy, take the <strong>Secret Key</strong> and <strong>Access Key</strong> from your own AWS account and use those to configure awscli profile</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws --profile configure &lt;profile-name&gt;
</code></pre></div></div>

<p>After that just enter the keys and an output format.</p>

<p>Now, that we have an AWS account and the bucket url we can try to list the contents of the bucket.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws s3 --profile &lt;profile-name&gt; ls s3://&lt;bucket-url&gt;
</code></pre></div></div>

<p>The contents of this bucket practically showed me the way to level 3.</p>

<h1 id="reached-level-3">Reached Level 3</h1>

<p>Heading over to the url we‚Äôre provided, it‚Äôs pretty obvious that there‚Äôs a .git directory inside that bucket
<img src="/assets/images/flaws-cloud/git-directory-xml.png" alt="" /></p>

<p>Then I downloaded the entire bucket, so that I can extract something from the .git directory.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws s3 sync s3://level3-9afd3927f195e10225021a578e6f78df.flaws.cloud/ . --no-sign-request --region us-east-1
</code></pre></div></div>

<p>By the way, we need to add this <strong>‚Äìno-sign-request</strong> flag because credentials were not loaded while making the request, probably because the bucket didn‚Äôt require us to have any.</p>

<p>I used <a href="https://github.com/internetwache/GitTools.git">GitTools</a> to extract information from the .git directory.</p>
:ET